!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.connector=t():e.connector=t()}(self,(()=>(()=>{"use strict";var e,t={5527:(e,t,n)=>{n.r(t),n.d(t,{ConnectorConnectorConfig:()=>f,render:()=>m});var o=n(961),r=n(6540),a=n(2374),s=n(7625),l=n(138),i=n(3217),c=n(6129),u=n(2505),p=n.n(u),d=function(){return d=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},d.apply(this,arguments)},f=function(){var e=(0,i.S3)()[0],t=e.theme,n=e.context,o=(0,r.useState)({email:"",password:""}),u=o[0],f=o[1],m=function(e){var t=e.target.name,n=e.target.value;f((function(e){var o;return d(d({},e),((o={})[t]=n,o))}))};return(0,r.useEffect)((function(){console.log(u),n&&(c.settings.registerOnSaveHandler((function(e){var t={email:u.email,password:u.password,contentUrl:"https://teams.perksweet.com/connectorConnector/config.html?name={loginHint}&tenant={tid}&group={groupId}&theme={theme}"};c.settings.setSettings(t),c.settings.getSettings((function(n){try{var o={email:t.email,password:t.password,webhook:n.webhookUrl};p().post("https://perksweet.com/api/configure-teams-webhook",o).then((function(t){console.log("Response: ",t),console.log("Response from Connector endpoint is: "+t.status),200===t.status||302===t.status?e.notifySuccess():e.notifyFailure("Invalid Credentials")})).catch((function(t){t.response?(console.log("axios - catch",t.response),e.notifyFailure("Invalid Credentials")):(console.log("axios - catch-else",t),e.notifyFailure("Invalid Credentials"))}))}catch(t){console.log("response in fetch-outer-catch",t),e.notifyFailure(t)}}))})),c.settings.registerOnRemoveHandler((function(e){c.settings.getSettings((function(t){var n;console.log("setting : ",t,e);var o={email:t.email,password:t.password,webhook:t.webhookUrl};p().post(null!==(n=process.env.BACKEND_REMOVE_ENDPOINT)&&void 0!==n?n:"",o).then((function(t){200===t.status||302===t.status?e.notifySuccess():e.notifyFailure(t.statusText)})).catch((function(t){throw console.log(t.response.data),console.log(t.response.status),console.log(t.response.headers),e.notifyFailure(t),new Error(t.response.status)}))}))})))}),[u.email,u.password,n]),(0,r.useEffect)((function(){if(n){var e=!1;u.email&&!/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/i.test(u.email)||!u.password||(e=!0),c.settings.setValidityState(e)}}),[u.email,u.password,n]),r.createElement(a.K,{theme:t},r.createElement(s.s,{fill:!0,column:!0},r.createElement(s.s.Item,null,r.createElement("div",null,r.createElement("p",{style:{fontWeight:"bold"}},"Important Notes:"),r.createElement("ul",{style:{marginBlockStart:"-8px"}},r.createElement("li",null,"No need to generate incoming webhook manually, just configure connector by using PerkSweet credentials."),r.createElement("li",null,"If you dont have account with PerkSweet, then please ",r.createElement("a",{href:"https://perksweet.com/register/company",target:"_blank",rel:"noopener noreferrer"},"Sign Up")," here. after signup, use that credentials to configure connector. so perksweet can post all updates of your organizations directly to your MS-Teams channel."),r.createElement("li",null,"This app will post update, whenever someone send kudos to another person in your organization, birthday updates & anniversary updates.")),r.createElement("h2",null,"Configure your Connector using PerkSweet Credentials"),r.createElement(l.pd,{type:"email",name:"email",value:u.email,required:!0,placeholder:"Email",onChange:m}),r.createElement("br",null),r.createElement("br",null),r.createElement(l.pd,{type:"password",name:"password",value:u.password,required:!0,placeholder:"Password",onChange:m}))),r.createElement(s.s.Item,null,r.createElement("div",null,r.createElement("p",null,"Don't have an account ? ",r.createElement("a",{href:"https://perksweet.com/register/company",target:"_blank",rel:"noopener noreferrer"},"Sign Up"))))))},m=function(e,t){o.render(r.createElement(e,{}),t)}}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e](a,a.exports,o),a.loaded=!0,a.exports}o.m=t,e=[],o.O=(t,n,r,a)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,r,a]=e[u],l=!0,i=0;i<n.length;i++)(!1&a||s>=a)&&Object.keys(o.O).every((e=>o.O[e](n[i])))?n.splice(i--,1):(l=!1,a<s&&(s=a));if(l){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,r,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={818:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[s,l,i]=n,c=0;if(s.some((t=>0!==e[t]))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(i)var u=i(o)}for(t&&t(n);c<s.length;c++)a=s[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(u)},n=self.webpackChunkconnector=self.webpackChunkconnector||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=o.O(void 0,[674],(()=>o(5527)));return o.O(r)})()));
//# sourceMappingURL=client.js.map